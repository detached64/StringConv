<Window x:Class="StringConv.Views.MainView"
        xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:i="using:StringConv.I18n"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:strconv="using:StringConv.Models.Converters"
        xmlns:vm="using:StringConv.ViewModels"
        Title="StringConv"
        d:DesignHeight="450"
        d:DesignWidth="800"
        x:DataType="vm:MainViewModel"
        Icon="/Assets/logo.ico"
        WindowStartupLocation="CenterScreen"
        mc:Ignorable="d">

    <Design.DataContext>
        <vm:MainViewModel />
    </Design.DataContext>

    <Window.Resources>
        <MenuFlyout x:Key="TranslatedTextBoxContextFlyout" Placement="Bottom">
            <MenuItem x:Name="TranslatedTextBoxContextFlyoutCutItem"
                      Command="{Binding $parent[TextBox].Cut}"
                      Header="{x:Static i:GuiStrings.Cut}"
                      InputGesture="{x:Static TextBox.CutGesture}"
                      IsEnabled="{Binding $parent[TextBox].CanCut}" />
            <MenuItem x:Name="TranslatedTextBoxContextFlyoutCopyItem"
                      Command="{Binding $parent[TextBox].Copy}"
                      Header="{x:Static i:GuiStrings.Copy}"
                      InputGesture="{x:Static TextBox.CopyGesture}"
                      IsEnabled="{Binding $parent[TextBox].CanCopy}" />
            <MenuItem x:Name="TranslatedTextBoxContextFlyoutPasteItem"
                      Command="{Binding $parent[TextBox].Paste}"
                      Header="{x:Static i:GuiStrings.Paste}"
                      InputGesture="{x:Static TextBox.PasteGesture}"
                      IsEnabled="{Binding $parent[TextBox].CanPaste}" />
        </MenuFlyout>
    </Window.Resources>

    <Window.Styles>
        <Style Selector="TextBox">
            <Setter Property="ContextFlyout" Value="{StaticResource TranslatedTextBoxContextFlyout}" />
        </Style>
    </Window.Styles>

    <DockPanel>
        <Menu DockPanel.Dock="Top">
            <MenuItem Command="{Binding ShowAboutCommand}"
                      CommandParameter="{Binding $parent[Window]}"
                      Header="{x:Static i:GuiStrings.About}" />
        </Menu>
        <Border Padding="2" DockPanel.Dock="Bottom">
            <TextBlock Foreground="{Binding Message.Color}" Text="{Binding Message.Text}" />
        </Border>
        <GridSplitter Background="Gray" DockPanel.Dock="Bottom" />
        <GridSplitter Background="Gray" DockPanel.Dock="Top" />
        <Grid ColumnDefinitions="*,1,*" DockPanel.Dock="Top">
            <ScrollViewer Margin="10,5">
                <DockPanel>
                    <ItemsControl DockPanel.Dock="Top" ItemsSource="{Binding PinnedConverterViewModels}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <TextBlock Margin="0,5" Text="{Binding Name}" />
                                    <TextBox Margin="0,5"
                                             AcceptsReturn="True"
                                             Text="{Binding Text}"
                                             TextWrapping="WrapWithOverflow" />
                                    <StackPanel.ContextMenu>
                                        <ContextMenu>
                                            <MenuItem Command="{Binding $parent[Window].((vm:MainViewModel)DataContext).RemoveCommand}"
                                                      CommandParameter="{Binding}"
                                                      Header="{x:Static i:GuiStrings.Remove}" />
                                            <MenuItem Command="{Binding $parent[Window].((vm:MainViewModel)DataContext).ClearCommand}" Header="{x:Static i:GuiStrings.Clear}" />
                                        </ContextMenu>
                                    </StackPanel.ContextMenu>
                                </StackPanel>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                    <TextBlock Margin="0,5"
                               DockPanel.Dock="Top"
                               Text="{x:Static i:GuiStrings.Hex}" />
                    <TextBox Margin="0,5"
                             AcceptsReturn="True"
                             DockPanel.Dock="Top"
                             IsReadOnly="True"
                             Text="{Binding HexText}"
                             TextWrapping="WrapWithOverflow" />
                </DockPanel>
            </ScrollViewer>
            <GridSplitter Grid.Column="1" Background="Gray" />
            <DockPanel Grid.Column="2" Margin="10">
                <Button Margin="0,10,0,0"
                        Command="{Binding CopyCommand}"
                        CommandParameter="{Binding $parent[Window]}"
                        Content="{x:Static i:GuiStrings.Copy}"
                        DockPanel.Dock="Bottom" />
                <TextBlock Margin="0,0,0,10"
                           DockPanel.Dock="Top"
                           Text="{x:Static i:GuiStrings.CopyData}" />
                <Grid ColumnDefinitions="Auto,0,*" DockPanel.Dock="Top">
                    <TreeView MinWidth="100"
                              ItemsSource="{Binding ConverterCategories}"
                              SelectedItem="{Binding SelectedConverter}"
                              SelectedItems="{Binding SelectedConverters}"
                              SelectionMode="Multiple">
                        <TreeView.DataTemplates>
                            <TreeDataTemplate DataType="vm:ConverterCategoryViewModel" ItemsSource="{Binding Converters}">
                                <TextBlock Text="{Binding Name}" />
                            </TreeDataTemplate>
                            <DataTemplate DataType="strconv:StringConverter">
                                <TextBlock Text="{Binding Name}">
                                    <TextBlock.ContextMenu>
                                        <ContextMenu>
                                            <MenuItem Command="{Binding $parent[Window].((vm:MainViewModel)DataContext).PinCommand}" Header="{x:Static i:GuiStrings.Pin}" />
                                            <MenuItem Command="{Binding $parent[Window].((vm:MainViewModel)DataContext).PinMultipleCommand}" Header="{x:Static i:GuiStrings.PinSelected}" />
                                        </ContextMenu>
                                    </TextBlock.ContextMenu>
                                </TextBlock>
                            </DataTemplate>
                        </TreeView.DataTemplates>
                    </TreeView>
                    <GridSplitter Grid.Column="1" Background="Gray" />
                    <TextBox Grid.Column="2"
                             AcceptsReturn="True"
                             IsReadOnly="True"
                             ScrollViewer.HorizontalScrollBarVisibility="Auto"
                             ScrollViewer.VerticalScrollBarVisibility="Auto"
                             Text="{Binding CopyText}"
                             TextWrapping="WrapWithOverflow" />
                </Grid>
            </DockPanel>
        </Grid>
    </DockPanel>
</Window>
